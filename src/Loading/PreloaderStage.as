package  {	import flash.display.MovieClip;	import flash.system.Security	import flash.display.StageAlign	import flash.display.StageScaleMode		import flash.events.Event;	import flash.events.MouseEvent;	import gs.TweenLite	import gs.easing.Expo	import gs.easing.Back	import flash.display.Loader;	import flash.net.URLRequest;	import flash.system.LoaderContext;	public class PreloaderStage extends MovieClip{		static public var _self:PreloaderStage		private var _preloader:MainPreloader		static public var _stageScale:Number=1		private var _mainLoader:Loader		private var _mainSwfOnline:String="MainStage.swf"		private var _mainPage:MovieClip		public function PreloaderStage() {			_self=this					Security.allowDomain("*")			Security.allowInsecureDomain("*")			stage.scaleMode=StageScaleMode.NO_SCALE			stage.align=StageAlign.TOP_LEFT			setup()		}		private function setup(){			if(stage.loaderInfo.parameters["xmlPath"]&&stage.loaderInfo.parameters["xmlPath"]!=""){				_mainSwfOnline=stage.loaderInfo.parameters["xmlPath"]			}else{							}						_preloader=_preloader_mc			_preloader.addEventListener(MainPreloader.EVENT_OUT,preloaderHander)							stage.addEventListener(Event.RESIZE,resizeHander)						resizeHander(null)						loadMainPage()		}		public function get _loadedPercent():Number{			return 10;		}		private function loadMainPage(){						var _urlR:URLRequest=new URLRequest(_mainSwfOnline)			_mainLoader=new Loader()						_preloader._LoaderInfo=_mainLoader.contentLoaderInfo			_mainLoader.load(_urlR,new LoaderContext(true))								}				private function preloaderHander(event:Event){			_gotoMain()		}		private function resizeHander(event:Event){						var _scale_h:Number=stage.stageHeight/600			var _scale_w:Number=stage.stageWidth/960												_stageScale=Math.min(_scale_h,_scale_w)			_stageScale=Math.max(0.5,_stageScale)			_stageScale=Math.min(1,_stageScale)						if(_preloader){				_preloader.x=0.5*stage.stageWidth				_preloader.y=0.5*stage.stageHeight				_preloader.scaleX=_preloader.scaleY=Math.max(_scale_h,_scale_w)			}						_bg.scaleX=_bg.scaleY=Math.max(_scale_h,_scale_w)			_bg.x=stage.stageWidth>>1			_bg.y=stage.stageHeight>>1			_intro.scaleX=_intro.scaleY=Math.max(_scale_h,_scale_w)			_intro.x=(stage.stageWidth>>1)-200			_intro.y=(stage.stageHeight>>1)-50		}		public function _gotoMain(){			TweenLite.to(_preloader,1,{alpha:0,onComplete:_startIt})								}		public function _startIt(){						gotoAndStop(3)						resizeHander(null)					var _m:MovieClip=_mainLoader.content as MovieClip									trace(_m)			//return			_mainPage=_m//.getChildAt(0)			_mainPage.addEventListener("EVENT_IN",mainPageHander)			addChild(_mainPage)		}		private function mainPageHander(event:Event){			trace("in")		}		//	}	}